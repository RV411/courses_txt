##################################################################
##################################################################
		Etapas del c√≥mputo forense
##################################################################
##################################################################

‚Ä¢ Primera etapa ‚ÄúIdentificaci√≥n‚Äù: reconocer nuestras fuentes de evidencia.
Resultados de la primera etapa
Como resultado obtendr√°s una cadena de custodia y un inventario de fuentes.

‚Ä¢ Segunda etapa ‚ÄúPreservaci√≥n‚Äù: conservar, guardar la evidencia de manera segura
Resultados de la segunda etapa
Como resultado obtendr√°s im√°genes forenses y reportes de adquisici√≥n y verificaci√≥n.

‚Ä¢ Tercera etapa ‚ÄúAn√°lisis‚Äù: procesamiento y an√°lisis de fuentes de informaci√≥n relacionada un evento.

Puntos clave a tener en cuenta tercera etapa
‚Äî Sistemas de Archivos: ¬øQu√© son?, ¬øcu√°les usamos com√∫nmente?, ¬øc√≥mo funcionan?
‚Äî Creaci√≥n de im√°genes parciales: Clasificaci√≥n de datos para an√°lisis.
‚Äî Exportado de archivos: Separaci√≥n de informaci√≥n.
‚Äî An√°lisis preliminar de Sistemas Operativos: Windows y Unix
‚Äì Los resultados del An√°lisis Preliminar ser√°n: informaci√≥n filtrada para an√°lisis y reporte preliminar de an√°lisis.
‚Äì Puntos claves a tener en cuenta para sistemas operativos:
‚Äî An√°lisis de usuarios de sistema: ¬øQu√© usuarios han estado activos en el sistema?
‚Äî An√°lisis de logs y procesos ejecutados: Reconstrucci√≥n de la actividad del Sistema Operativo.
‚Äî Recuperaci√≥n de archivos borrados: Reconstrucci√≥n y procesos de data carving.
‚Äî Artefactos espec√≠ficos de Sistema: Diferencias entre Windows y Unix.

Resultados de la tercera etapa
Como resultado obtendr√°s, resultados generales de la investigaci√≥n y posibles fuentes adicionales de consulta.


‚Ä¢ Cuarta etapa ‚ÄúPresentaci√≥n‚Äù: presentaremos resultados con un lenguaje adecuado y legible para los dem√°s.

‚Äì Puntos claves a tener en cuenta:
‚Äî Organizaci√≥n de la informaci√≥n: ¬øQu√© debemos incluir y qu√© no?, ¬øc√≥mo presentar los resultados y qu√© decir?
‚Äî Creaci√≥n de un informe t√©cnico: ¬øQu√© detalles debemos incluir?
‚Äî Creaci√≥n de un informe ejecutivo: ¬øQu√© lenguaje debemos utilizar?, ¬øc√≥mo resumir nuestros hallazgos?
‚Äî Presentaci√≥n ante autoridades: Consejos y recomendaciones
‚Äì Los resultados de la Presentaci√≥n ser√°n: informe t√©cnico e informe ejecutivo.



##################################################################
		Herramientas
##################################################################

Software:

    Linux Live USB: (Paladin Forensics / Kali / Otra)
    EnCase Imager
    FTK Imager Lite
    Inventario de Evidencia:
    	N√∫mero identificador
    	Custodio
    	Tipo de dispositivo
    	Marca
    	Modelo
    	N√∫mero de serie
    	N√∫mero de inventario
    	Capacidad de almacenamiento
    	Notas


https://drive.google.com/uc?id=1eojvJ0OBb8DWYLRAGejDkSRYT1nnjiSj&export=download




##################################################################
		Numero de serie
##################################################################


WINDOWS
wmic bios get serialnumber
Get-WmiObject win32_bios | Format-List SerialNumber
gwmi win32_bios | fl SerialNumber

MAC
system_profiler SPHardwareDataType | awk '/Serial/ {print $4}'
ioreg -l | awk '/IOPlatformSerialNumber/ { print $4;}'
ioreg -c IOPlatformExpertDevice -d 2 | awk -F\" '/IOPlatformSerialNumber/{print $(NF-1)}'

LINUX
sudo dmidecode | grep "^System Information" -A8


##################################################################
		Bloquear contra escritura
##################################################################

Write Bloquer

https://forensicswiki.xyz/wiki/index.php?title=Write_Blockers


##################################################################
		FTK Imager
##################################################################

FTK Imager: es una herramienta de an√°lisis forense disponible en la Web de AccessData, adem√°s que permite varios formatos para im√°genes.

‚Ä¢ Disco l√≥gico: es la secci√≥n de un disco que tenga un equivalente l√≥gico. No es una copia exacta.
‚Ä¢ Disco f√≠sico: cualquier disco que est√© conectado f√≠sicamente a la m√°quina.
‚Ä¢ Archivo de imagen: es una imagen forense que ya este creada.

https://accessdata.com/product-download/ftk-imager-version-4-2-0

https://security.opentext.com/encase-forensic-imager

##################################################################
		Imagenes de los datos
##################################################################

********************
RAW:= Imagen en crudo (Copia bits a bits, Menos usado)
Smart:= Formato ya no utilizado
E01:= Herramienta comercial para imagen forense (Mayor soporte,recomendado)
AFF:= Soportado solamente por acces data

******************

ENCASE de la empresa Guidance software ahora comprada por Opentext es una herramienta gratuita que podemos bajar directamente desde aqui despu√©s de llenar un formulario b√°sico obligatorio

lo primero es crear el caso llenando un formulario
despu√©s se adiciona la evidencia

Local Device: Cualquier dispositivo de almacenamiento f√≠sico

Network preview : Disco mapeado atravez de la red

Evidence File : Im√°genes forenses

Raw image: Imagen raw

Crossover Preview: Carga Varias im√°genes simult√°neamente

una vez determinada la fuente se debe escoger el formato de salida de la imagen, dentro de las cuales tenemos

Acquire: Crea imagen
Create Logical Evidence File: Crea imagen logica
Acquire Data Remotely: Adquisici√≥n por mapeo de disco en una red

El proceso se puede cancelar con un doble click tener cuidado

No genera reporte autom√°tico

tiene tama√±o fijo para las imagenes

Nota: todas las im√°genes creadas de un caso deben estar en una misma carpeta

cualquier correcci√≥n, aporte o aclaraci√≥n sera bien venida Gracias por leer.



##################################################################
		Adquisicion de Imagenes
##################################################################

Adquisici√≥n en Vivo
Con la versi√≥n live de Ftk imager Live ejecutable en una usb
tener un disco duro externo donde se almacenara la imagen adquirida

    se ejecuta FTK imager desde la unidad
    se escoje la opci√≥n imagen l√≥gica (esta solo copia el contenido del sistema de archivos)

    toma la partici√≥n que se desea copiar

    se llenan las notas de informaci√≥n del item

    Se escoje el destino de la imagen

    la imagen f√≠sica de un disco duro completo puede tardar bastante 4 o mas horas, las im√°genes l√≥gicas son mas r√°pidas pues copian el contenido no todo el disco

    El resultado es mas o menos igual que el de una imagen f√≠sica

para examinar se agrega evidencia y se selecciona la imagen generada

las im√°genes l√≥gicas solo muestran la informaci√≥n contenida en el sistema de archivos

Adquision de la memoria ram de un equipo

    se usa la opci√≥n Memory capture

    solo hay que seleccionar en donde se va a ubicar la captura de la memoria ram


memoria ram===pagefile.sys


##################################################################
		Adquisicion de Imagenes
##################################################################

****************paladin
Con paladin al montar las usb en lectura


****************dc3dd
el comando dd (data dump) en Linux originalmente se usa para copiar archivos en crudo (raw data) y su sintaxis es muy sencilla
dd if=/dev/sdb of=/ruta/destino/archivodestino

if= input file
of= output file

esta opci√≥n es muy simple y no cumple todas las necesidades de una imagen forense , para ello se utiliza el comando
dc3dd con la siguiente sintaxis

dc3dd if=/dev/sdb hofs=/ruta/destino/archivodestino ofsz=300MB hash=md5 hash=sha1 verb=on log=/ruta/destino/archivolog.txt

if = input file
h = hash
of = output file
s = split
ofsz= tama√±o de los bloques en los que queremos dividir la imagen
verb= barra de progreso

El archivo txt del log tiene todos los datos que requerimos como los resultados de los hash fecha de creaci√≥n, tama√±o etc




****************ftkimager
ftkimager para Linux puedes descargarlo desde aqui

    una vez lo descomprimas en el Linux que uses solo hay que ejecutarlo la sintaxis es sencilla pero con muchas opciones

como super usuario o usuario root ejecutamos

./ftkimager /dev/sdb /ruta/destino/nombreimagen --e01 --frag 300MB --compress 6 --case-number numerocaso --evidence-number numeroevidencia --description Imagen brevedescripcion --examiner nombre\investigador --notes notas\de la evidencia --verify

##################################################################
##################################################################
		Sistemas de Archivos
##################################################################
##################################################################
Conjunto de reglas y procesos para administrar la informaci√≥n en un medio de almacenamiento.
.
Tipos de archivos

‚Ä¢ Archivos o ficheros: conjunto de datos que tienen algo en com√∫n y est√°n delimitados.
‚Ä¢ Carpetas o directorios: contienen archivos en estructura jer√°rquica.
‚Ä¢ Archivos especiales: accesos directos.
.
Propiedades de archivos

‚Ä¢ Ruta: ubicaci√≥n l√≥gica de archivos en estructura jer√°rquica.
‚Ä¢ Metadatos: atributos y propiedades de un archivo.
‚Ä¢ Permisos: reglas de acceso, modificaci√≥n de archivos.

##################################################################
		Tipos de Archivos
##################################################################

NTFS el propietario es Microsoft y no es soportado por otros sistemas operativos

FAT
es como el indice de un libro, en donde solo se guarda donde se encuntra el documento



##################################################################
##################################################################
		Analisis pt2
##################################################################
##################################################################

RegRipper es la herramienta que se usa para extraer e interpretar informaci√≥n (llaves, valores y datos) desde el registro de Windows y presentarlos para su an√°lisis.
Genera dos archivos un log y el archivo reporte de SAM
se puede obtener entre otros datos los siguientes

    El nombre del usuario

    SID de los usuario de sistema incluido el administrador

    Nombre completo

    tipo de cuenta

    Ultima fecha de acceso del usuario

    Ultima fecha de acceso con password equivocado
    Ultima fecha de cambio de contrase√±a

    Estado de la cuenta (activa)

    La pista de contrase√±a

Los usuarios b√°sicos que necesita Windows para funcionar si ID comienza con el 500 para el administrador y 501 para el Invitado, despu√©s de estos todos los usuarios que se crean se asignan el id a partir del 1000 de manera consecutiva

Nota
Los numero Id de cada usuario no se reutilizan son √∫nicos para cada usuario de tal forma que si se borra un usuario su ID no se asigna a uno nuevo, esto permite reconstruir lka carpeta de un usuario borrado pues se tiene el id que tenia al observar el faltante en los consecutivos del ID

LastWrite es un valor com√∫n de las llaves de registro que se pueden modificar y siempre muestra cuando se modifico por ultima vez

##################################################################
		Analisis REGISTROS
##################################################################

La llave de registro SOFTWARE contiene informaci√≥n de las aplicaciones y software instalado en el equipo

    Cada secci√≥n corresponde a un pluggin que muestra caracter√≠sticas de las aplicaciones instadas con datos como

    fecha de modificaci√≥n
    Ubicaci√≥n de los ejecutables
    Versi√≥n de la aplicaci√≥n
    fecha de instalaci√≥n

El pluggin unistall contiene la informaci√≥n de las aplicaciones disponibles para des instalar en el panel de control




##################################################################
		Analisis LOGS
##################################################################

Esta clase es esencial para quienes est√°n aprendiendo Elasticsearch o Splunk, es decir, quienes se est√°n iniciando al an√°lisis de Logs de seguridad con gestores para visualizaci√≥n masiva. Todo esto beneficia a quien est√© perfil√°ndose para un trabajo tipo SOC (Security Operations Center,


Logs de Windows est√°n en
Windows/System32/winevt/logs

Los tres archivos de log importantes son System, Aplication, Security

    System: Contiene informaci√≥n relacionada con los servicios y sistemas propios del sistema operativo

    Security: Contiene la informaci√≥n de eventos accesos permisos pol√≠ticas del sistema operativo con un ID de seguridad en donde podemos ver el usuario del sistema que genero el evento

    Aplication: Contiene la informaci√≥n de las aplicaciones instaladas y ejecutadas dentro del sistema operativo


##################################################################
	Analisis  (MRU) y Shellbags
##################################################################

Los Shellbags son llaves de registro que almacenan la configuraci√≥n de visualizaci√≥n del usuario, es decir, cuando nosotros podemos darle tama√±o a los iconos, cambiar colores, entre otras.


ShellBagsView
Es el interprete que podemos usar para establecer
https://www.nirsoft.net/utils/shell_bags_view.html

MRU y Shellbags
Dentro de la carpeta de cada usuario encontramos el archivo NTUSER.DAT que necesitaremos para analizar y adicional se usara el archivo Userclas.dat que esta en /usuario/APPdata/local/Microsoft/windows/

Si bien es cierto el Shell Bags solo guarda la configuraci√≥n de las carpetas e iconos que el usuario visualiza a medida que navega por el escritorio, si se mira con cuidado es como ver las huellas que deja una persona que camino por la arena y es ah√≠ donde la herramienta ShellBagsView es muy √∫til


##################################################################
		Analisis Procesos ejecutados
##################################################################

Es una estrategia que en Windows se usa para ayudar a los programas que se usan frecuentemente a cargar mas r√°pido.

Ubicada en Windows\Prefetch

Prefetching:
- Estrategia para acelerar la carga de apps
- Archivos con informaci√≥n relacionada a la aplicaci√≥n
- Se generan y actualizan cuando se ejecuta el proceso
‚óã Fecha de creaci√≥n: La primera vez que se ejecuto
- Base de datos
‚óã Direcciones de librer√≠as
‚óã Direcci√≥n de ejecutable
‚óã Cantidad de veces que se ha ejecutado ese proceso

¬øC√≥mo obtenerla?
- Windows
- Prefetch
Al exportar, se cambia la ubicaci√≥n y cambia fecha de modificaci√≥n

¬øC√≥mo interpretar?
PECmd

PECmd.exe
PECmd.exe -f ‚ÄúC:\Users\Desktop\Data\Datos.exe-779BD542.pf‚Äù csv

https://github.com/EricZimmerman/PECmd
mas programas de Zimmer https://ericzimmerman.github.io/#!index.md

Filesload: √ötil para an√°lisis de malware



##################################################################
		Analisis RECICLAJE
##################################################################

Papelera de Reciclaje:

    Espacio de almacenamiento temporal.
    Capacidad m√°xima de 4GB o el 10% de la partici√≥n.
    Debe contener informaci√≥n para recuperar los archivos.
    C:$Recycle.Bin (Directorio de almacenamiento)
    
    Dos archivos por cada elemento borrado:
        $IXXXXXX.* (Info para restaurar/ruta original)
        $RXXXXXX.* (Nuevo nombre que se le da por ser borrado)




##################################################################
##################################################################
			LINUX
##################################################################
##################################################################

Primer paso: El BIOS
El BIOS (Basic Input/Basic Output) es el primer sistema que carga el procesador cuando se enciende. El BIOS se encarga de detectar el hardware disponible y proporcionar un primer acceso a los dispositivos perif√©ricos, as√≠ como de identificar un dispositivo desde el cual iniciar el sistema (regularmente, la primera partici√≥n de un disco local). Una vez el BIOS encuentra un dispositivo disponible para iniciar, le deja el control del sistema a √©ste.

Segundo paso: El gestor de arranque
En los sistemas Unix existen diferentes gestores de arranque. √âste se encarga de escoger un sistema operativo a partir de una lista de dispositivos y sectores de arranque disponibles. El gestor de arranque m√°s com√∫n en Linux probablemente sea GRUB (GRand Unified Bootloader), pero existen otros y es com√∫n encontrarlos.

Tercer paso: El kernel de Linux
El kernel es el proceso principal que ejecuta el sistema operativo Unix y del que dependen todos los dem√°s procesos. Se encarga de administrar los controladores necesarios para usar el hardware, inicializa el sistema de archivos y prepara la memoria.

Cuarto paso: proceso /sbin/init
Este proceso se encarga de configurar el entorno de usuario. Los archivos de configuraci√≥n de este proceso se encuentran en la carpeta /etc/inittab, y el primer script que se ejecuta es /etc/init.d/rcS.

A nivel l√≥gico, el proceso init es el proceso del que derivan todos los dem√°s procesos autom√°ticos del sistema. √âste ejecuta todos los procesos que se encuentran en la carpeta /etc/rcS.d/ y en /etc/rc.boot/. Estas carpetas son una gran fuente de referencia para revisar los procesos que se ejecutan por defecto al iniciar el sistema.

El proceso de inicio de procesos descrito es el que ha sido utilizado tradicionalmente en la gran mayor√≠a de distribuciones de Linux. Sin embargo, existen otras alternativas y otros sistemas desarrollados para cumplir el mismo prop√≥sito. Como siempre, es importante que sigas aprendiendo y te documentes en todas estas herramientas, porque cambian constantemente y debes estar preparado para entender lo que te encuentres en campo.


##################################################################
		USUARIOS
##################################################################
Configuraci√≥n de usuarios:

    Los usuarios se almacenan en dos archivos:
        /etc/passwd
        /etc/shadow
    Usuarios con privilegios de administraci√≥n
        /etc/sudoers
    Configuraci√≥n de grupos:
        /etc/group

Sintaxis /etc/passwd:

user:x:1001:1001:just a user,111,,:/home/user:/bin/bash

    Nombre de usuario
    Password
    ID de usuario (UID)
    ID de grupo (GID)
    Nombre completo
    Carpeta home
    Shell de acceso

Sintaxis /etc/shadow:

user:$1$HESu9xrH$k.o3G93DGoXliQKkPmUgZ0:14699:0:99999:7:::

    Nombre de usuario
    Password cifrado
    	$1$=MD5 (22 caracteres)
	$2$=blowfish
	$5$=SHA-256 (43 Caracteres)
	$6$=SHA-512 (86 Caracteres)
    √öltimo cambio de password (D√≠as desde el 01/01/1970)
    M√≠nimo de d√≠as para cambiar el password
    M√°ximo de d√≠as en que es v√°lido despu√©s de alerta
    N√∫mero de d√≠as de alerta
    N√∫mero de d√≠as para desactivar la cuenta
    Expiraci√≥n de la cuenta


##################################################################
		LOG SYSTEM
##################################################################


La carpeta var log contiene los registros de todo lo que sucede en el sistema, en el kernel, con los usuarios, los programas y mucho m√°s.

Registro de eventos:
- /var/log

Usar MANDIANT para analizar los logs
https://www.fireeye.com/services/freeware/highlighter-download-confirmation.html
‚óã Mapa:
	¬ß Te permite resaltar
	¬ß Remover lineas
‚óã ACPI: Modulo que administra el sistema de energ√≠a



##################################################################
		AUTOPSY
##################################################################
https://dfir-training.basistech.com/courses/autopsy-basics-8-hours

Autopsy para realizar nuestras im√°genes de una manera mucho m√°s gr√°fica.



##################################################################
##################################################################
		Reportes
##################################################################
##################################################################


Etapas:
- Nidificaci√≥n:
	‚óã Cadena de custodia
	‚óã Inventario de evidencia
	‚óã Fuentes de informaci√≥n
- Preservaci√≥n
	‚óã Obtener im√°genes forenses
	‚óã Autentificar
- An√°lisis
	‚óã Generalidades de sistemas operativos
	‚óã Detalles de c√≥mo analizar
- Presentaci√≥n
	‚óã Condensar la informaci√≥n encontrada para despu√©s presentar
	http://freemind.sourceforge.net/wiki/index.php/Download

Estructura de un informe
Herramienta FreeMind
- Mapas / Arboles




##################################################################
		Ejecutivo && t√©cnico
##################################################################

Informe ejecutivo

    Introducci√≥n
        Presentaci√≥n del caso
        Evidencia
    Resumen ejecutivo
    Linea del tiempo
    Marco legal
    Detalles t√©cnicos
    Documentos / Anexos
    
    
Informe t√©cnico
    Introducci√≥n
        Presentaci√≥n del caso
        Evidencia
    Resumen ejecutivo
    Metodolog√≠a
    Procedimientos
        Identificaci√≥n
        Preservaci√≥n
        An√°lisis
        Presentaci√≥n
    Documentos t√©cnicos
    Glosario
    Herramientas, Fuentes‚Ä¶
    Conclusiones o recomendaciones

    
    (Pi√©nsalo como si fueses un detective de esas pel√≠culas/series que tanto miras üòâ)


##################################################################
		Presentacion en autoridades
##################################################################

Recuerda que debes ser neutral, nunca ir m√°s de un lado o de otro, o esto denotar√° nuestra falta de profesionalismo.

**************Consejos:
1. Conocete: Saber que rol tienes
a. Qui√©n eres y que autoridad tienes
2. Conocer a la contraparte
3. No emitir juicios
	a. Investigador solo relata hechos
	b. "El usuario asignado a esta persona ‚Ä¶"
4. Preparate
	a. Conocer herramientas
	b. Capacitaci√≥n
	c. Experiencia
5. Asesorarse de un abogado
	a. Asegurarse de ser claro y no dejar espacio a mal interpretaciones

##################################################################
		Condenas
##################################################################

Cuando uno comete un delito existen tres tipos basicos de condena:
-la social.
-la penal.
-la institucional/ o empresarial.

Dicho esto, dependiendo el tipo de delito y el contexto en que se de, ser√° quien establezca a fin de cuentas cual va a ser el castigo en relaci√≥n a lo sucedido.

Contestando a tu pregunta; si vos robas el papel higi√©nico de la empresa y se percatan de ello, el gerente o jefe del sector en el que est√©s trabajando, ser√° quien te de la pena institucional. Luego el delito se ver√° si es para llevarlo a un nivel penal. Y socialmente, a fin de cuentas‚Ä¶es muy gracioso ¬øno tenias papel en casa?

Lo explico as√≠, para que te quede sencillo ^^

##################################################################
		LIBROS
##################################################################
Metodologias y de m√°s
Hacking Exposed Computer Forensics  Secrets and solutions

Como funciona windows
Windows Registry Forensics

Harlan Carvey el mejor para forensics
Digital Forensics with open source tools

Mas actualizado
Digital Forensics

Como recuperar datos a muy bajo nivel, manejo de herramientas
EnCE Study Guide



##################################################################
##################################################################
		Paginas
##################################################################
##################################################################

Windows Incident Response 
https://windowsir.blogspot.com/p/books.html

Explicar como funcionan algunas cosas
https://forensicswiki.xyz/page/Main_Page

Articulos
https://digital-forensics.sans.org/training

Metodos e interpretaciones
https://www.forensicfocus.com/
